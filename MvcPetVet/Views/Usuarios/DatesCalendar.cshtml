@model List<Cita>

@{
    Layout = "_TemplateUser";
    ViewData["Title"] = "Calendario de Citas";
}


<div id="root">
    <div id="app">
        <div id="calendar-background-wrapper">
            <div id="calendar-background"></div>
        </div><div id="calendar">
            <div id="calendar-dates" style="">

                <button id="date-2022-01-30" class="date-wrapper" disabled="">
                    <div class="date">
                        <div class="date-day">
                            <h2 class="date-day-of-month">30</h2>
                            <h2 class="date-day-of-week">Mon</h2>
                        </div>
                    </div>
                </button>
                <button id="date-2022-01-31" class="date-wrapper" disabled="">
                    <div class="date">
                        <div class="date-day">
                            <h2 class="date-day-of-month">31</h2>
                            <h2 class="date-day-of-week">Tue</h2>
                        </div>
                    </div>
                </button>
                <button id="date-2022-02-01" class="date-wrapper active-day active-month">
                    <div class="date">
                        <div class="date-day">
                            <h2 class="date-day-of-month">1</h2><h2 class="date-day-of-week">Wed</h2>
                        </div><div class="date-title"><div class="date-title-dot"></div><h2>Dark Chocolate Day</h2></div>
                    </div><div class="active-day-indicator"></div>
                </button>
                <button id="date-2022-02-02" class="date-wrapper active-month">
                    <div class="date">
                        <div class="date-day">
                            <h2 class="date-day-of-month">2</h2><h2 class="date-day-of-week">Thu</h2>
                        </div><div class="date-title"><div class="date-title-dot"></div><h2>Groundhog Day</h2></div>
                    </div>
                </button>
                <button id="date-2022-02-03" class="date-wrapper active-month">
                    <div class="date">
                        <div class="date-day">
                            <h2 class="date-day-of-month">3</h2>
                            <h2 class="date-day-of-week">Fri</h2>
                        </div><div class="date-title"><div class="date-title-dot"></div><h2>Carrot Cake Day</h2></div>
                    </div>
                </button><button id="date-2022-02-04" class="date-wrapper active-month"><div class="date"><div class="date-day"><h2 class="date-day-of-month">4</h2><h2 class="date-day-of-week">Sat</h2></div><div class="date-title"><div class="date-title-dot"></div><h2>Wear Red Day</h2></div></div></button><button id="date-2022-02-05" class="date-wrapper active-month"><div class="date"><div class="date-day"><h2 class="date-day-of-month">5</h2><h2 class="date-day-of-week">Sun</h2></div><div class="date-title"><div class="date-title-dot"></div><h2>Weatherperson's Day</h2></div></div></button><button id="date-2022-02-06" class="date-wrapper active-month"><div class="date"><div class="date-day"><h2 class="date-day-of-month">6</h2><h2 class="date-day-of-week">Mon</h2></div><div class="date-title"><div class="date-title-dot"></div><h2>Chopsticks Day</h2></div></div></button><button id="date-2022-02-07" class="date-wrapper active-month"><div class="date"><div class="date-day"><h2 class="date-day-of-month">7</h2><h2 class="date-day-of-week">Tue</h2></div><div class="date-title"><div class="date-title-dot"></div><h2>Periodic Table Day</h2></div></div></button><button id="date-2022-02-08" class="date-wrapper active-month"><div class="date"><div class="date-day"><h2 class="date-day-of-month">8</h2><h2 class="date-day-of-week">Wed</h2></div><div class="date-title"><div class="date-title-dot"></div><h2>Kite Flying Day</h2></div></div></button><button id="date-2022-02-09" class="date-wrapper active-month"><div class="date"><div class="date-day"><h2 class="date-day-of-month">9</h2><h2 class="date-day-of-week">Thu</h2></div><div class="date-title"><div class="date-title-dot"></div><h2>Pizza Day</h2></div></div></button><button id="date-2022-02-10" class="date-wrapper active-month"><div class="date"><div class="date-day"><h2 class="date-day-of-month">10</h2><h2 class="date-day-of-week">Fri</h2></div><div class="date-title"><div class="date-title-dot"></div><h2>Umbrella Day</h2></div></div></button><button id="date-2022-02-11" class="date-wrapper active-month"><div class="date"><div class="date-day"><h2 class="date-day-of-month">11</h2><h2 class="date-day-of-week">Sat</h2></div><div class="date-title"><div class="date-title-dot"></div><h2>Inventor's Day</h2></div></div></button><button id="date-2022-02-12" class="date-wrapper active-month"><div class="date"><div class="date-day"><h2 class="date-day-of-month">12</h2><h2 class="date-day-of-week">Sun</h2></div><div class="date-title"><div class="date-title-dot"></div><h2>Global Movie Day</h2></div></div></button><button id="date-2022-02-13" class="date-wrapper active-month"><div class="date"><div class="date-day"><h2 class="date-day-of-month">13</h2><h2 class="date-day-of-week">Mon</h2></div><div class="date-title"><div class="date-title-dot"></div><h2>Tortellini Day</h2></div></div></button><button id="date-2022-02-14" class="date-wrapper active-month"><div class="date"><div class="date-day"><h2 class="date-day-of-month">14</h2><h2 class="date-day-of-week">Tue</h2></div><div class="date-title"><div class="date-title-dot"></div><h2>Valentine's Day</h2></div></div></button><button id="date-2022-02-15" class="date-wrapper active-month"><div class="date"><div class="date-day"><h2 class="date-day-of-month">15</h2><h2 class="date-day-of-week">Wed</h2></div><div class="date-title"><div class="date-title-dot"></div><h2>Gumdrop Day</h2></div></div></button><button id="date-2022-02-16" class="date-wrapper active-month"><div class="date"><div class="date-day"><h2 class="date-day-of-month">16</h2><h2 class="date-day-of-week">Thu</h2></div><div class="date-title"><div class="date-title-dot"></div><h2>Do a Grouch a Favor Day</h2></div></div></button><button id="date-2022-02-17" class="date-wrapper active-month"><div class="date"><div class="date-day"><h2 class="date-day-of-month">17</h2><h2 class="date-day-of-week">Fri</h2></div><div class="date-title"><div class="date-title-dot"></div><h2>Cabbage Day</h2></div></div></button><button id="date-2022-02-18" class="date-wrapper active-month"><div class="date"><div class="date-day"><h2 class="date-day-of-month">18</h2><h2 class="date-day-of-week">Sat</h2></div><div class="date-title"><div class="date-title-dot"></div><h2>Battery Day</h2></div></div></button><button id="date-2022-02-19" class="date-wrapper active-month"><div class="date"><div class="date-day"><h2 class="date-day-of-month">19</h2><h2 class="date-day-of-week">Sun</h2></div><div class="date-title"><div class="date-title-dot"></div><h2>Chocolate Mint Day</h2></div></div></button><button id="date-2022-02-20" class="date-wrapper active-month"><div class="date"><div class="date-day"><h2 class="date-day-of-month">20</h2><h2 class="date-day-of-week">Mon</h2></div><div class="date-title"><div class="date-title-dot"></div><h2>Love Your Pet Day</h2></div></div></button><button id="date-2022-02-21" class="date-wrapper active-month"><div class="date"><div class="date-day"><h2 class="date-day-of-month">21</h2><h2 class="date-day-of-week">Tue</h2></div><div class="date-title"><div class="date-title-dot"></div><h2>President's Day</h2></div></div></button><button id="date-2022-02-22" class="date-wrapper active-month"><div class="date"><div class="date-day"><h2 class="date-day-of-month">22</h2><h2 class="date-day-of-week">Wed</h2></div><div class="date-title"><div class="date-title-dot"></div><h2>Cook a Sweet Potato Day</h2></div></div></button><button id="date-2022-02-23" class="date-wrapper active-month"><div class="date"><div class="date-day"><h2 class="date-day-of-month">23</h2><h2 class="date-day-of-week">Thu</h2></div><div class="date-title"><div class="date-title-dot"></div><h2>Tile Day</h2></div></div></button><button id="date-2022-02-24" class="date-wrapper active-month"><div class="date"><div class="date-day"><h2 class="date-day-of-month">24</h2><h2 class="date-day-of-week">Fri</h2></div><div class="date-title"><div class="date-title-dot"></div><h2>Toast Day</h2></div></div></button><button id="date-2022-02-25" class="date-wrapper active-month"><div class="date"><div class="date-day"><h2 class="date-day-of-month">25</h2><h2 class="date-day-of-week">Sat</h2></div><div class="date-title"><div class="date-title-dot"></div><h2>Clam Chowder Day</h2></div></div></button><button id="date-2022-02-26" class="date-wrapper active-month"><div class="date"><div class="date-day"><h2 class="date-day-of-month">26</h2><h2 class="date-day-of-week">Sun</h2></div><div class="date-title"><div class="date-title-dot"></div><h2>Pistachio Day</h2></div></div></button><button id="date-2022-02-27" class="date-wrapper active-month"><div class="date"><div class="date-day"><h2 class="date-day-of-month">27</h2><h2 class="date-day-of-week">Mon</h2></div><div class="date-title"><div class="date-title-dot"></div><h2>Polar Bear Day</h2></div></div></button><button id="date-2022-02-28" class="date-wrapper active-month"><div class="date"><div class="date-day"><h2 class="date-day-of-month">28</h2><h2 class="date-day-of-week">Tue</h2></div><div class="date-title"><div class="date-title-dot"></div><h2>Tooth Fairy Day</h2></div></div></button><button id="date-2022-03-01" class="date-wrapper" disabled=""><div class="date"><div class="date-day"><h2 class="date-day-of-month">1</h2><h2 class="date-day-of-week">Wed</h2></div></div></button><button id="date-2022-03-02" class="date-wrapper" disabled=""><div class="date"><div class="date-day"><h2 class="date-day-of-month">2</h2><h2 class="date-day-of-week">Thu</h2></div></div></button><button id="date-2022-03-03" class="date-wrapper" disabled=""><div class="date"><div class="date-day"><h2 class="date-day-of-month">3</h2><h2 class="date-day-of-week">Fri</h2></div></div></button><button id="date-2022-03-04" class="date-wrapper" disabled=""><div class="date"><div class="date-day"><h2 class="date-day-of-month">4</h2><h2 class="date-day-of-week">Sat</h2></div></div></button><button id="date-2022-03-05" class="date-wrapper" disabled=""><div class="date"><div class="date-day"><h2 class="date-day-of-month">5</h2><h2 class="date-day-of-week">Sun</h2></div></div></button>
            </div>
        </div>
    </div>
</div>


@*<header>
    <div class="wrapper">
        <div class="c-monthyear">
            <div class="c-month">
                <span id="prev" class="prev fa fa-angle-left" aria-hidden="true"></span>
                <div id="c-paginator">
                    <span class="c-paginator__month">JANUARY</span>
                    <span class="c-paginator__month">FEBRUARY</span>
                    <span class="c-paginator__month">MARCH</span>
                    <span class="c-paginator__month">APRIL</span>
                    <span class="c-paginator__month">MAY</span>
                    <span class="c-paginator__month">JUNE</span>
                    <span class="c-paginator__month">JULY</span>
                    <span class="c-paginator__month">AUGUST</span>
                    <span class="c-paginator__month">SEPTEMBER</span>
                    <span class="c-paginator__month">OCTOBER</span>
                    <span class="c-paginator__month">NOVEMBER</span>
                    <span class="c-paginator__month">DECEMBER</span>
                </div>
                <span id="next" class="next fa fa-angle-right" aria-hidden="true"></span>
            </div>
            <span class="c-paginator__year">2022</span>
        </div>
        <div class="c-sort">
            <a class="o-btn c-today__btn" href="javascript:;">TODAY</a>
        </div>
    </div>
</header>*@


<script>
    //global variables
    var monthEl = $(".c-main");
    var dataCel = $(".c-cal__cel");
    var dateObj = new Date();
    var month = dateObj.getUTCMonth() + 1;
    var day = dateObj.getUTCDate();
    var year = dateObj.getUTCFullYear();
    var monthText = [
        "January",
        "February",
        "March",
        "April",
        "May",
        "June",
        "July",
        "August",
        "September",
        "October",
        "November",
        "December"
    ];
    var indexMonth = month;
    var todayBtn = $(".c-today__btn");
    var addBtn = $(".js-event__add");
    var saveBtn = $(".js-event__save");
    var closeBtn = $(".js-event__close");
    var winCreator = $(".js-event__creator");
    var inputDate = $(this).data();
    today = year + "-" + month + "-" + day;

    // ------ set default events -------
    function defaultEvents(dataDay, dataName, dataNotes, classTag) {
        var date = $("*[data-day=" + dataDay + "]");
        date.attr("data-name", dataName);
        date.attr("data-notes", dataNotes);
        date.addClass("event");
        date.addClass("event--" + classTag);
    }

    defaultEvents(today, "YEAH!", "Today is your day", "important");
    defaultEvents(
        "2022-12-25",
        "MERRY CHRISTMAS",
        "A lot of gift!!!!",
        "festivity"
    );
    defaultEvents("2022-05-04", "LUCA'S BIRTHDAY", "Another gifts...?", "birthday");
    defaultEvents(
        "2022-03-03",
        "MY LADY'S BIRTHDAY",
        "A lot of money to spent!!!!",
        "birthday"
    );

    // ------ functions control -------

    //button of the current day
    todayBtn.on("click", function () {
        if (month < indexMonth) {
            var step = indexMonth % month;
            movePrev(step, true);
        } else if (month > indexMonth) {
            var step = month - indexMonth;
            moveNext(step, true);
        }
    });

    //higlight the cel of current day
    dataCel.each(function () {
        if ($(this).data("day") === today) {
            $(this).addClass("isToday");
            fillEventSidebar($(this));
        }
    });

    //window event creator
    addBtn.on("click", function () {
        winCreator.addClass("isVisible");
        $("body").addClass("overlay");
        dataCel.each(function () {
            if ($(this).hasClass("isSelected")) {
                today = $(this).data("day");
                document.querySelector('input[type="date"]').value = today;
            } else {
                document.querySelector('input[type="date"]').value = today;
            }
        });
    });
    closeBtn.on("click", function () {
        winCreator.removeClass("isVisible");
        $("body").removeClass("overlay");
    });
    saveBtn.on("click", function () {
        var inputName = $("input[name=name]").val();
        var inputDate = $("input[name=date]").val();
        var inputNotes = $("textarea[name=notes]").val();
        var inputTag = $("select[name=tags]").find(":selected").text();

        dataCel.each(function () {
            if ($(this).data("day") === inputDate) {
                if (inputName != null) {
                    $(this).attr("data-name", inputName);
                }
                if (inputNotes != null) {
                    $(this).attr("data-notes", inputNotes);
                }
                $(this).addClass("event");
                if (inputTag != null) {
                    $(this).addClass("event--" + inputTag);
                }
                fillEventSidebar($(this));
            }
        });

        winCreator.removeClass("isVisible");
        $("body").removeClass("overlay");
        $("#addEvent")[0].reset();
    });

    //fill sidebar event info
    function fillEventSidebar(self) {
        $(".c-aside__event").remove();
        var thisName = self.attr("data-name");
        var thisNotes = self.attr("data-notes");
        var thisImportant = self.hasClass("event--important");
        var thisBirthday = self.hasClass("event--birthday");
        var thisFestivity = self.hasClass("event--festivity");
        var thisEvent = self.hasClass("event");

        switch (true) {
            case thisImportant:
                $(".c-aside__eventList").append(
                    "<p class='c-aside__event c-aside__event--important'>" +
                    thisName +
                    " <span> • " +
                    thisNotes +
                    "</span></p>"
                );
                break;
            case thisBirthday:
                $(".c-aside__eventList").append(
                    "<p class='c-aside__event c-aside__event--birthday'>" +
                    thisName +
                    " <span> • " +
                    thisNotes +
                    "</span></p>"
                );
                break;
            case thisFestivity:
                $(".c-aside__eventList").append(
                    "<p class='c-aside__event c-aside__event--festivity'>" +
                    thisName +
                    " <span> • " +
                    thisNotes +
                    "</span></p>"
                );
                break;
            case thisEvent:
                $(".c-aside__eventList").append(
                    "<p class='c-aside__event'>" +
                    thisName +
                    " <span> • " +
                    thisNotes +
                    "</span></p>"
                );
                break;
        }
    }
    dataCel.on("click", function () {
        var thisEl = $(this);
        var thisDay = $(this).attr("data-day").slice(8);
        var thisMonth = $(this).attr("data-day").slice(5, 7);

        fillEventSidebar($(this));

        $(".c-aside__num").text(thisDay);
        $(".c-aside__month").text(monthText[thisMonth - 1]);

        dataCel.removeClass("isSelected");
        thisEl.addClass("isSelected");
    });

    //function for move the months
    function moveNext(fakeClick, indexNext) {
        for (var i = 0; i < fakeClick; i++) {
            $(".c-main").css({
                left: "-=100%"
            });
            $(".c-paginator__month").css({
                left: "-=100%"
            });
            switch (true) {
                case indexNext:
                    indexMonth += 1;
                    break;
            }
        }
    }
    function movePrev(fakeClick, indexPrev) {
        for (var i = 0; i < fakeClick; i++) {
            $(".c-main").css({
                left: "+=100%"
            });
            $(".c-paginator__month").css({
                left: "+=100%"
            });
            switch (true) {
                case indexPrev:
                    indexMonth -= 1;
                    break;
            }
        }
    }

    //months paginator
    function buttonsPaginator(buttonId, mainClass, monthClass, next, prev) {
        switch (true) {
            case next:
                $(buttonId).on("click", function () {
                    if (indexMonth >= 2) {
                        $(mainClass).css({
                            left: "+=100%"
                        });
                        $(monthClass).css({
                            left: "+=100%"
                        });
                        indexMonth -= 1;
                    }
                    return indexMonth;
                });
                break;
            case prev:
                $(buttonId).on("click", function () {
                    if (indexMonth <= 11) {
                        $(mainClass).css({
                            left: "-=100%"
                        });
                        $(monthClass).css({
                            left: "-=100%"
                        });
                        indexMonth += 1;
                    }
                    return indexMonth;
                });
                break;
        }
    }

    buttonsPaginator("#next", monthEl, ".c-paginator__month", false, true);
    buttonsPaginator("#prev", monthEl, ".c-paginator__month", true, false);

    //launch function to set the current month
    moveNext(indexMonth - 1, false);

    //fill the sidebar with current day
    $(".c-aside__num").text(day);
    $(".c-aside__month").text(monthText[month - 1]);

</script>